<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PM Dashboard</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', monospace;
      background: #0a0a0f;
      color: #e0e0e0;
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 800px; margin: 0 auto; }
    h1 { font-size: 1.5rem; margin-bottom: 10px; }
    .wallet {
      font-family: monospace;
      font-size: 0.75rem;
      color: #888;
      word-break: break-all;
      margin-bottom: 30px;
    }
    .card {
      background: #12121a;
      border: 1px solid #1e1e2e;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .card-title {
      font-size: 0.8rem;
      color: #888;
      text-transform: uppercase;
      margin-bottom: 15px;
    }
    .balance-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #1e1e2e;
    }
    .balance-row:last-child { border-bottom: none; }
    .amount { font-size: 1.2rem; font-weight: 600; }
    .usd { color: #888; font-size: 0.85rem; }
    .total { font-size: 2rem; font-weight: 700; color: #4ade80; }
    .status { color: #888; font-size: 0.85rem; margin-top: 20px; }
    .error { color: #f87171; }
    .loading { color: #60a5fa; }
    button {
      background: #1e1e2e;
      border: none;
      color: #e0e0e0;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover { background: #2a2a3a; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ° PM Dashboard</h1>
    <div class="wallet">0x707163889b0f0eFf77db30AA3990aBEa26A525b4</div>

    <div class="card">
      <div class="card-title">Total Value</div>
      <div class="total" id="total">Loading...</div>
    </div>

    <div class="card">
      <div class="card-title">Balances</div>
      <div class="balance-row">
        <span>ðŸ’µ USDC</span>
        <div>
          <div class="amount" id="usdc">--</div>
        </div>
      </div>
      <div class="balance-row">
        <span>â¬¡ POL</span>
        <div>
          <div class="amount" id="pol">--</div>
          <div class="usd" id="pol-usd">--</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">Positions</div>
      <div id="positions">No positions yet - start trading on Polymarket!</div>
    </div>

    <div class="status" id="status">Loading...</div>
    <button onclick="refresh()">â†» Refresh</button>
  </div>

  <script>
    const WALLET = '0x707163889b0f0eFf77db30AA3990aBEa26A525b4';
    const RPC = 'https://polygon-bor-rpc.publicnode.com';
    const USDC = '0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174'; // USDC.e (bridged) - what Polymarket uses

    function setStatus(msg, isError) {
      const el = document.getElementById('status');
      el.textContent = msg;
      el.className = 'status ' + (isError ? 'error' : 'loading');
    }

    async function rpcCall(method, params) {
      const res = await fetch(RPC, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ jsonrpc: '2.0', method, params, id: 1 })
      });
      const data = await res.json();
      if (data.error) throw new Error(data.error.message);
      return data.result;
    }

    async function refresh() {
      setStatus('Fetching balances...', false);
      
      try {
        // POL balance
        const polHex = await rpcCall('eth_getBalance', [WALLET, 'latest']);
        const pol = parseInt(polHex, 16) / 1e18;
        document.getElementById('pol').textContent = pol.toFixed(4) + ' POL';
        document.getElementById('pol-usd').textContent = '~$' + (pol * 0.40).toFixed(2);

        // USDC balance
        const addr = WALLET.slice(2).toLowerCase().padStart(64, '0');
        const usdcHex = await rpcCall('eth_call', [{ to: USDC, data: '0x70a08231' + addr }, 'latest']);
        const usdc = parseInt(usdcHex, 16) / 1e6;
        document.getElementById('usdc').textContent = usdc.toFixed(2) + ' USDC';

        // Total
        const total = usdc + (pol * 0.40);
        document.getElementById('total').textContent = '$' + total.toFixed(2);

        setStatus('Updated ' + new Date().toLocaleTimeString(), false);
      } catch (e) {
        setStatus('Error: ' + e.message, true);
        console.error(e);
      }
    }

    refresh();
  </script>
</body>
</html>
